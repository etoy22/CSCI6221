<!DOCTYPE html>
<html>
<head>
	<title>Library</title>
</head>
<body>
	<!-- Greeting message w	<h1>Hello, {{ name }}!</h1>
ith the {{ user }} variable -->
    <a href="search">
        <input type="button" name="Search" id="Search" value="Add New Movies"/>
    </a>
    <input type="button" name="RemoveMovies" id="RemoveMovies" value="Remove Selected Movies" onclick="removeContent()"/>
	<ul id="list"></ul>

	<table>
		<thead>
		  <tr>
			<th>Select</th>
			<th>ID</th>
			<th>Title</th>
			<th>Release Date</th>
			<th>Overview</th>
		  </tr>
		</thead>
		<tbody>
		  {% for movie in movies %}
			<tr>
	          <td><input type="checkbox" name="selected_movies[]" value="{{ movie.ID }}"></td>
			  <td>{{ movie.ID }}</td>
			  <td>{{ movie.Title }}</td>
			  <td>{{ movie.Release_date }}</td>
			  <td>{{ movie.Overview }}</td>
			</tr>
		  {% endfor %}
		</tbody>
	  </table>
	  
	<script>
		// Function for removing content
		function removeContent() {
			const selectedMovies = [];
			const checkboxes = document.getElementsByName('selected_movies[]');
			
			for (let i = 0; i < checkboxes.length; i++) {
				if (checkboxes[i].checked) {
					selectedMovies.push(checkboxes[i].value);
				}
			}
			
			console.log(selectedMovies);
			// Make a HTTP POST request to the server
			fetch('/remove_movies', {
				method: 'POST',
				headers: {
				'Content-Type': 'application/json'
				},
				body: JSON.stringify({selectedMovies: selectedMovies})
			})
			.then(response => response.json())
			.then(data => {
				const success = data.success;
				console.log("Success:",success)
				if (!success) {
				window.alert('Removed Nothing');
				} else {
				window.location.href = "/library"
				}
			})
			.catch(error => console.error(error));
		}

		
		
	</script>
</body>
</html>
